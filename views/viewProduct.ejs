<!-- viewProduct.ejs -->
<html>
  <head>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/global.css">
    <link rel="stylesheet" href="/viewProductOrCategory.css">
    <title>View Product</title>
  </head>
  <body>
    <%- include("partials/header.ejs") %>

    <div class="container">
      <div class="heading">
        <a class="returnProducts button" href="/products">Return to Products</a>
      </div>

      <div class="main">
        <div class="product-card">
          <div class="product-header">
            <div class="product-emoji"><%= product.emoji %></div>
            <div class="product-title">
              <h2><%= product.product_name %></h2>
              <span class="brand">by <%= product.brand %></span>
            </div>
            <div class="price">$<%= product.price %></div>
          </div>

          <div class="product-details">
            <div class="detail">
              <span class="label">Quantity</span>
              <span class="value"><%= product.quantity %></span>
            </div>

            <div class="detail">
              <span class="label">Category</span>
              <span
                class="category-badge"
                data-color="<%= product.color %>"
                style="background-color: <%= product.color %>;"
              >
                <%= product.category_name %>
              </span>
            </div>
          </div>

            <div class="product-actions">
              <a
                class="button edit-button"
                href="/products/edit/<%= product.product_id %>"
              >
                ‚úèÔ∏è Edit
              </a>

              <form
                action="/products/<%= product.product_id %>?_method=DELETE"
                method="POST"
              >
                <button type="submit" class="button delete-button">
                  üóë Delete
                </button>
              </form>
          </div>
        </div>
      </div>
    </div>

    <%- include("partials/footer.ejs") %>



    <script>
      document.querySelectorAll('.category-badge').forEach(badge => {
        const bg = badge.dataset.color;
        if (!bg) return;

        const hex = bg.replace('#', '');
        const r = parseInt(hex.substring(0, 2), 16);
        const g = parseInt(hex.substring(2, 4), 16);
        const b = parseInt(hex.substring(4, 6), 16);

        // Perceived luminance
        const luminance = 0.299 * r + 0.587 * g + 0.114 * b;

        badge.style.color = luminance < 140 ? '#ffffff' : '#333333';
      });
    </script>
  </body>
</html>
